/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package ui;

import java.awt.event.KeyEvent;
import java.time.LocalDateTime;
import java.util.Calendar;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import model.CarHistory;
import model.CarInfo;
import java.util.function.ObjDoubleConsumer;
import java.util.regex.Matcher;
import java.util.regex.Pattern;





/**
 *
 * @author adity
 */
public class ViewJPanel extends javax.swing.JPanel {

    /**
     * Creates new form ViewJPanel
     */
    
    
    CarHistory history;
    
    public ViewJPanel(CarHistory history) {
        
        initComponents();
        this.history = history;
        
        int endYear = Calendar.getInstance().get(Calendar.YEAR);
        this.history = history;

        //String listYear[] = new String[25];
        jComboBoxYearOfManufacturing.addItem("--Please Select--");       
        for(int year = endYear; year > endYear-25; year--){
            jComboBoxYearOfManufacturing.addItem(Integer.toString(year));
        }
        
        populateTable();
        txtLastUpdatedFleetDetails.setText(String.valueOf(LocalDateTime.now()));
      
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup = new javax.swing.ButtonGroup();
        lblTitle1 = new javax.swing.JLabel();
        btnView = new javax.swing.JButton();
        btnDelete = new javax.swing.JButton();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblCars = new javax.swing.JTable();
        lblcountOfSeats = new javax.swing.JLabel();
        lblavailability = new javax.swing.JLabel();
        lblmaintainenceCertStatus = new javax.swing.JLabel();
        txtCarModelName = new javax.swing.JTextField();
        txtCarModelNumber = new javax.swing.JTextField();
        txtSerialNo = new javax.swing.JTextField();
        jCombocarManufacturer = new javax.swing.JComboBox<>();
        jComboLocation = new javax.swing.JComboBox<>();
        jComboNoOfSeats = new javax.swing.JComboBox<>();
        lblcarModelName = new javax.swing.JLabel();
        btnRadioYes = new javax.swing.JRadioButton();
        lblcarManufacturer = new javax.swing.JLabel();
        btnRadioNo = new javax.swing.JRadioButton();
        lblcarModelNo = new javax.swing.JLabel();
        btnCheckActive = new javax.swing.JCheckBox();
        lblyearOfManufacturing = new javax.swing.JLabel();
        lblserialNo = new javax.swing.JLabel();
        lblcity = new javax.swing.JLabel();
        btnUpdate = new javax.swing.JButton();
        btnUpdateSave = new javax.swing.JButton();
        jComboBoxYearOfManufacturing = new javax.swing.JComboBox<>();
        lblErrorCarModelName1 = new javax.swing.JLabel();
        lblErrorCarModelNum1 = new javax.swing.JLabel();
        lblErrorSerialNumber1 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        txtLastUpdatedFleetDetails = new javax.swing.JTextField();

        setBackground(new java.awt.Color(0, 0, 0));
        setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));
        addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                formKeyPressed(evt);
            }
        });

        lblTitle1.setBackground(new java.awt.Color(0, 0, 0));
        lblTitle1.setFont(new java.awt.Font("Gill Sans MT", 1, 24)); // NOI18N
        lblTitle1.setForeground(new java.awt.Color(255, 255, 255));
        lblTitle1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTitle1.setText("View Car Details");

        btnView.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        btnView.setText("View");
        btnView.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));
        btnView.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnViewActionPerformed(evt);
            }
        });

        btnDelete.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        btnDelete.setText("Delete");
        btnDelete.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));
        btnDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDeleteActionPerformed(evt);
            }
        });

        tblCars.setBackground(new java.awt.Color(204, 204, 204));
        tblCars.setFont(new java.awt.Font("Gill Sans MT", 1, 11)); // NOI18N
        tblCars.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Manufacturer", "Model Name", "Model No.", "Manufacturing Year", "Serial No.", "Location", "No. of Seats", "Availability", "Maintainence Status"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, true, true, true
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane2.setViewportView(tblCars);

        lblcountOfSeats.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblcountOfSeats.setForeground(new java.awt.Color(255, 255, 255));
        lblcountOfSeats.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblcountOfSeats.setText("No. of Seats:");

        lblavailability.setFont(new java.awt.Font("Gill Sans MT", 1, 11)); // NOI18N
        lblavailability.setForeground(new java.awt.Color(255, 255, 255));
        lblavailability.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblavailability.setText("Availability:");

        lblmaintainenceCertStatus.setFont(new java.awt.Font("Gill Sans MT", 1, 11)); // NOI18N
        lblmaintainenceCertStatus.setForeground(new java.awt.Color(255, 255, 255));
        lblmaintainenceCertStatus.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblmaintainenceCertStatus.setText("Maintainence Certificate Status:");

        txtCarModelName.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtCarModelNameActionPerformed(evt);
            }
        });
        txtCarModelName.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtCarModelNameKeyPressed(evt);
            }
        });

        txtCarModelNumber.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtCarModelNumberActionPerformed(evt);
            }
        });
        txtCarModelNumber.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtCarModelNumberKeyPressed(evt);
            }
        });

        txtSerialNo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSerialNoActionPerformed(evt);
            }
        });
        txtSerialNo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtSerialNoKeyPressed(evt);
            }
        });

        jCombocarManufacturer.setBackground(new java.awt.Color(0, 0, 0));
        jCombocarManufacturer.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        jCombocarManufacturer.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "--Select from options--", "Toyota", "Hyundai", "TATA", "BMW", "Audi", "Mercedes", "Tesla" }));
        jCombocarManufacturer.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jCombocarManufacturer.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jCombocarManufacturerActionPerformed(evt);
            }
        });

        jComboLocation.setBackground(new java.awt.Color(0, 0, 0));
        jComboLocation.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        jComboLocation.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "--Select from options--", "Boston", "New York", "Chicago", "Norwalk", "New Jersey", "San Jose", "Seattle" }));
        jComboLocation.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        jComboNoOfSeats.setBackground(new java.awt.Color(0, 0, 0));
        jComboNoOfSeats.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        jComboNoOfSeats.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "--Select from options--", "2", "4", "5", "6", "9" }));
        jComboNoOfSeats.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jComboNoOfSeats.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboNoOfSeatsActionPerformed(evt);
            }
        });

        lblcarModelName.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblcarModelName.setForeground(new java.awt.Color(255, 255, 255));
        lblcarModelName.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblcarModelName.setText("Car Model Name:");

        btnRadioYes.setBackground(new java.awt.Color(0, 0, 0));
        buttonGroup.add(btnRadioYes);
        btnRadioYes.setForeground(new java.awt.Color(255, 255, 255));
        btnRadioYes.setText("Yes");

        lblcarManufacturer.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblcarManufacturer.setForeground(new java.awt.Color(255, 255, 255));
        lblcarManufacturer.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblcarManufacturer.setText("Car Manufacturer:");

        btnRadioNo.setBackground(new java.awt.Color(0, 0, 0));
        buttonGroup.add(btnRadioNo);
        btnRadioNo.setForeground(new java.awt.Color(255, 255, 255));
        btnRadioNo.setText("No");

        lblcarModelNo.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblcarModelNo.setForeground(new java.awt.Color(255, 255, 255));
        lblcarModelNo.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblcarModelNo.setText("Car Model No.:");

        btnCheckActive.setBackground(new java.awt.Color(0, 0, 0));
        btnCheckActive.setText("Active");
        btnCheckActive.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCheckActiveActionPerformed(evt);
            }
        });

        lblyearOfManufacturing.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblyearOfManufacturing.setForeground(new java.awt.Color(255, 255, 255));
        lblyearOfManufacturing.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblyearOfManufacturing.setText("Year of Manufacturing:");

        lblserialNo.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblserialNo.setForeground(new java.awt.Color(255, 255, 255));
        lblserialNo.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblserialNo.setText("Serial No.:");

        lblcity.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblcity.setForeground(new java.awt.Color(255, 255, 255));
        lblcity.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblcity.setText("Location:");

        btnUpdate.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        btnUpdate.setText("Update");
        btnUpdate.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));
        btnUpdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUpdateActionPerformed(evt);
            }
        });

        btnUpdateSave.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        btnUpdateSave.setText("Save");
        btnUpdateSave.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));
        btnUpdateSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUpdateSaveActionPerformed(evt);
            }
        });

        jComboBoxYearOfManufacturing.setBackground(new java.awt.Color(0, 0, 0));
        jComboBoxYearOfManufacturing.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        jComboBoxYearOfManufacturing.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "--Select from options--" }));
        jComboBoxYearOfManufacturing.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        lblErrorCarModelName1.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblErrorCarModelName1.setForeground(new java.awt.Color(255, 255, 255));

        lblErrorCarModelNum1.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblErrorCarModelNum1.setForeground(new java.awt.Color(255, 255, 255));

        lblErrorSerialNumber1.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        lblErrorSerialNumber1.setForeground(new java.awt.Color(255, 255, 255));

        jLabel1.setFont(new java.awt.Font("Gill Sans MT", 1, 12)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel1.setText("Last Fleet Updated Time:");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(67, 67, 67)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(lblcarManufacturer, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lblcarModelNo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lblyearOfManufacturing, javax.swing.GroupLayout.DEFAULT_SIZE, 172, Short.MAX_VALUE)
                            .addComponent(lblserialNo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lblcity, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lblcountOfSeats, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lblcarModelName, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblmaintainenceCertStatus, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(lblavailability, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(btnRadioYes)
                        .addGap(18, 18, 18)
                        .addComponent(btnRadioNo))
                    .addComponent(btnCheckActive)
                    .addComponent(jComboLocation, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtSerialNo)
                    .addComponent(txtCarModelNumber)
                    .addComponent(txtCarModelName)
                    .addComponent(jCombocarManufacturer, 0, 186, Short.MAX_VALUE)
                    .addComponent(jComboNoOfSeats, 0, 186, Short.MAX_VALUE)
                    .addComponent(jComboBoxYearOfManufacturing, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                .addGap(0, 133, Short.MAX_VALUE)
                                .addComponent(btnView, javax.swing.GroupLayout.PREFERRED_SIZE, 65, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnUpdate, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnDelete, javax.swing.GroupLayout.PREFERRED_SIZE, 65, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(layout.createSequentialGroup()
                                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 165, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(txtLastUpdatedFleetDetails))
                                    .addGroup(layout.createSequentialGroup()
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addComponent(lblErrorCarModelName1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                            .addComponent(lblErrorCarModelNum1, javax.swing.GroupLayout.DEFAULT_SIZE, 320, Short.MAX_VALUE)
                                            .addComponent(lblErrorSerialNumber1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                        .addGap(0, 0, Short.MAX_VALUE)))
                                .addContainerGap())))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnUpdateSave, javax.swing.GroupLayout.PREFERRED_SIZE, 86, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap())))
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane2)
                    .addComponent(lblTitle1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(12, 12, 12)
                .addComponent(lblTitle1, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 184, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(layout.createSequentialGroup()
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(btnView, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(btnUpdate, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(btnDelete, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGap(23, 23, 23))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblcarManufacturer, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addComponent(jCombocarManufacturer, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)))
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtCarModelName, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(lblcarModelName, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(lblErrorCarModelName1, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtCarModelNumber, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(lblcarModelNo, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(lblErrorCarModelNum1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(1, 1, 1)
                        .addComponent(jComboBoxYearOfManufacturing, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(lblyearOfManufacturing, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblserialNo, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtSerialNo, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblcity, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jComboLocation, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblcountOfSeats, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jComboNoOfSeats, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblavailability, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnRadioYes)
                            .addComponent(btnRadioNo))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblmaintainenceCertStatus, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnCheckActive))
                        .addGap(0, 20, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(lblErrorSerialNumber1, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(35, 35, 35)
                        .addComponent(btnUpdateSave, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtLastUpdatedFleetDetails, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel1))
                        .addContainerGap())))
        );
    }// </editor-fold>//GEN-END:initComponents

    // <editor-fold defaultstate="collapsed" desc="Generated Code">

    
    
    private void btnViewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnViewActionPerformed
        // TODO add your handling code here:
        
        JOptionPane.showMessageDialog(this, "Selected Car information will be displayed");
        
        int selectedRowIndex = tblCars.getSelectedRow();
        
        if (selectedRowIndex<0){
            JOptionPane.showMessageDialog(this, "Please select a row to view details.");
            return;
        }
        
        DefaultTableModel model = (DefaultTableModel) tblCars.getModel();
        CarInfo selectedCar = (CarInfo) model.getValueAt(selectedRowIndex, 0);
        
        jCombocarManufacturer.setSelectedItem(selectedCar.getCarManufacturer());
        txtCarModelName.setText(selectedCar.getCarModelname());
        txtCarModelNumber.setText(selectedCar.getCarModelNum());
        jComboBoxYearOfManufacturing.setSelectedItem(selectedCar.getYearOfManufacturing());
        txtSerialNo.setText(String.valueOf(selectedCar.getSerialNumber()));
        jComboLocation.setSelectedItem(selectedCar.getCity());
        jComboNoOfSeats.setSelectedItem(String.valueOf(selectedCar.getCountOfSeats()));
        
        if(selectedCar.getAvailability() == "Yes" ){
            btnRadioYes.setSelected(true);
            btnRadioNo.setSelected(false);
        }else {
            btnRadioNo.setSelected(true);
            btnRadioYes.setSelected(false);
        }
        
        if(selectedCar.getMaintainenceCertStatus() == "Yes" ){
            btnCheckActive.setSelected(true);
        }else {
            btnCheckActive.setSelected(false);
        }
        
    }//GEN-LAST:event_btnViewActionPerformed

    private void btnDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDeleteActionPerformed
        int selectedRowIndex = tblCars.getSelectedRow();
        
        if (selectedRowIndex<0){
            JOptionPane.showMessageDialog(this, "Please select a row to delete.");
            return;
        }
        
        DefaultTableModel model = (DefaultTableModel) tblCars.getModel();
        CarInfo selectedCar = (CarInfo) model.getValueAt(selectedRowIndex, 0);
        
        history.deleteCar(selectedCar);
        
        JOptionPane.showMessageDialog(this, "Car information deleted");
        
        populateTable();
        
        txtLastUpdatedFleetDetails.setText(String.valueOf(LocalDateTime.now()));
        
        
    }//GEN-LAST:event_btnDeleteActionPerformed

    private void btnUpdateSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUpdateSaveActionPerformed
        // TODO add your handling code here:
        int selectedRowIndex = tblCars.getSelectedRow();
         if(selectedRowIndex  < 0) {
           JOptionPane.showMessageDialog(this, "Please select a row to update the Car details");
           return;
        }
         
        DefaultTableModel model = (DefaultTableModel) tblCars.getModel();
        
        String carManufacturer = jCombocarManufacturer.getSelectedItem().toString();
        String carModelname = txtCarModelName.getText();
        String carModelNum = txtCarModelNumber.getText();
        String yearOfManufacturing = jComboBoxYearOfManufacturing.getSelectedItem().toString();
        String serialNumber = txtSerialNo.getText();
        String city = jComboLocation.getSelectedItem().toString();
        String countOfSeats = jComboNoOfSeats.getSelectedItem().toString();
        
        String carModelNamePattern = "^[a-zA-z]+";
        Pattern expCarModelName = Pattern.compile(carModelNamePattern);

        String serialNumberPattern = "^[0-9]{6}+";
        Pattern expSerialNumber = Pattern.compile(serialNumberPattern);

        String carModelNumPattern = "^[a-zA-Z0-9]+";
        Pattern expCarModelNum = Pattern.compile(carModelNumPattern);
        
        if(txtCarModelName.getText().isEmpty()|| txtCarModelNumber.getText().isEmpty() || txtSerialNo.getText().isEmpty() ){
            JOptionPane.showMessageDialog(this, "Fields are mandatory !!");
        }else {
            if(carManufacturer == "--Select from options--" || city == "--Select from options--" || countOfSeats == "--Select from options--" || yearOfManufacturing == "--Select from options--"){
                JOptionPane.showMessageDialog(this, "Please check the fields.");
            }else{
                Matcher matchCarModelName = expCarModelName.matcher(txtCarModelName.getText());
                if(!matchCarModelName.matches()){
                    lblErrorCarModelName1.setText("Enter a valid car model name!!");
                }else{
                    lblErrorCarModelName1.setText(" ");
                    Matcher matchSerialNumber = expSerialNumber.matcher(txtSerialNo.getText());
                    if(!matchSerialNumber.matches()){
                        lblErrorSerialNumber1.setText("Enter a valid Serial Number");
                    }else{
                        Matcher matchCarModelNum = expCarModelNum.matcher(txtCarModelNumber.getText());
                        lblErrorSerialNumber1.setText(" ");
                        if(!matchCarModelNum.matches()){
                            lblErrorCarModelNum1.setText("Enter a valid Car Model Number!!");
                        }else{
                            lblErrorCarModelNum1.setText(" ");
                            if(selectedRowIndex >= 0){

                                JOptionPane.showMessageDialog(this, "Selected record will be updated!!");

                                model.setValueAt(jCombocarManufacturer.getSelectedItem(), selectedRowIndex, 0);
                                model.setValueAt(txtCarModelName.getText(), selectedRowIndex, 1);
                                model.setValueAt(txtCarModelNumber.getText(), selectedRowIndex, 2);
                                model.setValueAt(jComboBoxYearOfManufacturing.getSelectedItem(), selectedRowIndex, 3);
                                model.setValueAt(txtSerialNo.getText(), selectedRowIndex, 4);
                                model.setValueAt(jComboLocation.getSelectedItem().toString(), selectedRowIndex, 5);
                                model.setValueAt(jComboNoOfSeats.getSelectedItem(), selectedRowIndex, 6);
                                
                                if(btnRadioYes.isSelected()){
                                    model.setValueAt("Yes", selectedRowIndex, 7);
                                }else {
                                    model.setValueAt("No", selectedRowIndex, 7);
                                }

                                if(btnCheckActive.isSelected()){
                                     model.setValueAt("Yes", selectedRowIndex, 8);
                                }else {
                                     JOptionPane.showMessageDialog(this, "For Maintenance Certificate as nothing is selected its considered to be 'NO' ");
                                     //carDetails.setMainCertiExpiry("No");
                                     model.setValueAt("No", selectedRowIndex, 8);
                                }
                              
                            }else{
                                JOptionPane.showMessageDialog(this, "Records could not be upated!!");
                            }
                        }
                            //clearing the text after the car details are saved
                            jCombocarManufacturer.setSelectedItem("--Select from options--");
                            txtCarModelName.setText("");
                            txtCarModelNumber.setText("");
                            jComboBoxYearOfManufacturing.setSelectedItem("--Select from options--");
                            txtSerialNo.setText("");
                            jComboLocation.setSelectedItem("--Select from options--");
                            jComboNoOfSeats.setSelectedItem("--Select from options--");
                            buttonGroup.clearSelection();
                            btnCheckActive.setSelected(false);
                            
                            txtLastUpdatedFleetDetails.setText(String.valueOf(LocalDateTime.now()));
                        }
                    }
                }
            }   
    }//GEN-LAST:event_btnUpdateSaveActionPerformed

    private void jComboNoOfSeatsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboNoOfSeatsActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jComboNoOfSeatsActionPerformed

    private void jCombocarManufacturerActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jCombocarManufacturerActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jCombocarManufacturerActionPerformed

    private void txtCarModelNameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtCarModelNameActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtCarModelNameActionPerformed

    private void formKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_formKeyPressed
        // TODO add your handling code here:
    }//GEN-LAST:event_formKeyPressed

    
    
    
    
    private void txtCarModelNameKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtCarModelNameKeyPressed
        // TODO add your handling code here:
        
        char c =evt.getKeyChar();

        if(Character.isLetter(c) || Character.isWhitespace(c)|| Character.isISOControl(c)){
            lblErrorCarModelName1.setText(" ");
            txtCarModelName.setEditable(true);

        }else {
            if(!Character.isLetter(c)){
                // txtName.setEditable(false);
                lblErrorCarModelName1.setText("Enter a valid name");
            }
        }
       
    }//GEN-LAST:event_txtCarModelNameKeyPressed

    private void txtCarModelNumberKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtCarModelNumberKeyPressed
        // TODO add your handling code here:
        String carModelNum = txtCarModelNumber.getText();
        String PATTERN = "^[a-zA-Z0-9]+";
        Pattern exp = Pattern.compile(PATTERN);
        Matcher match = exp.matcher(carModelNum);
        if(!match.matches()){
            lblErrorCarModelNum1.setText("Enter a valid Model Number.");
        }else{
            lblErrorCarModelNum1.setText(" ");
        }
        
    }//GEN-LAST:event_txtCarModelNumberKeyPressed

    private void txtSerialNoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSerialNoKeyPressed
        // TODO add your handling code here:
        
        String serialNumber = txtSerialNo.getText();
        int length = serialNumber.length();

        char c = evt.getKeyChar();

        if(evt.getKeyChar()>='0' && evt.getKeyChar()<='9'){
            if(length<6){
                txtSerialNo.setEditable(true);
                lblErrorSerialNumber1.setText("Serial Numner should be 6 digits");
            }else{
                txtSerialNo.setEditable(false);
                lblErrorSerialNumber1.setText(" ");
            }
        }else{
            if(evt.getExtendedKeyCode()==KeyEvent.VK_BACK_SPACE || evt.getExtendedKeyCode()==KeyEvent.VK_DELETE){
                txtSerialNo.setEditable(true);
            }else{
                txtSerialNo.setEditable(false);
            }
        }
        
    }//GEN-LAST:event_txtSerialNoKeyPressed

    private void btnUpdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUpdateActionPerformed
        // TODO add your handling code here:
        int selectedRowIndex = tblCars.getSelectedRow();
         if(selectedRowIndex  < 0) {
           JOptionPane.showMessageDialog(this, "Please select a row to update the Car details");
           return;
        }
         
       DefaultTableModel model = (DefaultTableModel) tblCars.getModel();
       
       CarInfo selectedCarDetails = (CarInfo) model.getValueAt(selectedRowIndex, 0);
       jCombocarManufacturer.setSelectedItem(selectedCarDetails.getCarManufacturer());
       txtCarModelName.setText(selectedCarDetails.getCarModelname());
       txtCarModelNumber.setText(selectedCarDetails.getCarModelNum());
       jComboBoxYearOfManufacturing.setSelectedItem(selectedCarDetails.getYearOfManufacturing());
       txtSerialNo.setText(String.valueOf(selectedCarDetails.getSerialNumber()));
       jComboLocation.setSelectedItem(selectedCarDetails.getCity());
       jComboNoOfSeats.setSelectedItem(String.valueOf(selectedCarDetails.getCountOfSeats()));
       if(selectedCarDetails.getAvailability() == "Yes" ){
           btnRadioYes.setSelected(false);
          // noChecked.setSelected(false);
       }else {
           btnRadioNo.setSelected(true);
           btnRadioYes.setSelected(false);
       }
       if(selectedCarDetails.getMaintainenceCertStatus() == "Yes" ){
           btnCheckActive.setSelected(true);
       }else {
            btnCheckActive.setSelected(false);
       }
      
        btnUpdateSave.setEnabled(true);
        jCombocarManufacturer.setEnabled(true);
        txtCarModelName.setEditable(true);
        txtCarModelNumber.setEditable(true);
        jComboBoxYearOfManufacturing.setEnabled(true);
        txtSerialNo.setEditable(true);
        jComboLocation.setEnabled(true);
        jComboNoOfSeats.setEnabled(true);
        btnCheckActive.setEnabled(true);
        btnRadioYes.setEnabled(true);
        btnRadioNo.setEnabled(true);
        
        
    }//GEN-LAST:event_btnUpdateActionPerformed

    private void txtCarModelNumberActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtCarModelNumberActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtCarModelNumberActionPerformed

    private void btnCheckActiveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCheckActiveActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnCheckActiveActionPerformed

    private void txtSerialNoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSerialNoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSerialNoActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JCheckBox btnCheckActive;
    private javax.swing.JButton btnDelete;
    private javax.swing.JRadioButton btnRadioNo;
    private javax.swing.JRadioButton btnRadioYes;
    private javax.swing.JButton btnUpdate;
    private javax.swing.JButton btnUpdateSave;
    private javax.swing.JButton btnView;
    private javax.swing.ButtonGroup buttonGroup;
    private javax.swing.JComboBox<String> jComboBoxYearOfManufacturing;
    private javax.swing.JComboBox<String> jComboLocation;
    private javax.swing.JComboBox<String> jComboNoOfSeats;
    private javax.swing.JComboBox<String> jCombocarManufacturer;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JLabel lblErrorCarModelName1;
    private javax.swing.JLabel lblErrorCarModelNum1;
    private javax.swing.JLabel lblErrorSerialNumber1;
    private javax.swing.JLabel lblTitle1;
    private javax.swing.JLabel lblavailability;
    private javax.swing.JLabel lblcarManufacturer;
    private javax.swing.JLabel lblcarModelName;
    private javax.swing.JLabel lblcarModelNo;
    private javax.swing.JLabel lblcity;
    private javax.swing.JLabel lblcountOfSeats;
    private javax.swing.JLabel lblmaintainenceCertStatus;
    private javax.swing.JLabel lblserialNo;
    private javax.swing.JLabel lblyearOfManufacturing;
    private javax.swing.JTable tblCars;
    private javax.swing.JTextField txtCarModelName;
    private javax.swing.JTextField txtCarModelNumber;
    private javax.swing.JTextField txtLastUpdatedFleetDetails;
    private javax.swing.JTextField txtSerialNo;
    // End of variables declaration//GEN-END:variables

    private void populateTable() {
        DefaultTableModel model = (DefaultTableModel) tblCars.getModel();
        model.setRowCount(0);
        
        for (CarInfo ci : history.getHistory()){
            
            Object[] row = new Object[9];
            
            row[0]=ci;
            row[1]=ci.getCarModelname();
            row[2]=ci.getCarModelNum();
            row[3]=ci.getYearOfManufacturing();
            row[4]=ci.getSerialNumber();
            row[5]=ci.getCity();
            row[6]=ci.getCountOfSeats();
            row[7]=ci.getAvailability();
            row[8]=ci.getMaintainenceCertStatus();
            
            model.addRow(row);
        
            
        
        
        
        }
        
    
    }
}
